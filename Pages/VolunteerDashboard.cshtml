@page
@model GoMad.Pages.VolunteerDashboardModel
@{
    ViewData["Title"] = "Panel de Voluntario";
    Layout = null; // Completamente independiente del layout de ancianos
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GoMad - Panel de Voluntario</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="vol-body">

    <!-- Navbar exclusiva de voluntarios -->
    <nav class="vol-navbar">
        <div class="vol-navbar-brand">
            <img src="/Imagenes/GoMad%20logo.png" alt="GoMad" class="vol-navbar-logo" />
            <span class="vol-navbar-title">GoMad Voluntarios</span>
        </div>
        <div class="vol-navbar-links">
            <button class="vol-nav-link active" data-section="pedidos" onclick="showSection('pedidos')">ğŸ“‹ Pedidos</button>
            <button class="vol-nav-link" data-section="ruta" onclick="showSection('ruta')">ğŸ—ºï¸ Ruta</button>
        </div>
        <div class="vol-navbar-user">
            <span class="vol-navbar-email">@Model.VolunteerEmail</span>
            <form method="post" asp-page-handler="Logout" style="display:inline">
                <button type="submit" class="vol-nav-logout">Cerrar sesiÃ³n</button>
            </form>
        </div>
    </nav>

    <!-- Mobile bottom tabs -->
    <div class="vol-mobile-tabs">
        <button class="vol-mobile-tab active" data-section="pedidos" onclick="showSection('pedidos')">ğŸ“‹<span>Pedidos</span></button>
        <button class="vol-mobile-tab" data-section="ruta" onclick="showSection('ruta')">ğŸ—ºï¸<span>Ruta</span></button>
    </div>

    <div class="vol-main">

        <!-- ====== SECCIÃ“N: PEDIDOS ====== -->
        <section id="section-pedidos" class="vol-section active">
            <div class="vol-section-header">
                <h2>ğŸ“‹ Pedidos pendientes</h2>
                <span class="vol-badge">3 pendientes</span>
            </div>

            <div class="vol-card-list">
                <div class="vol-order-card pending">
                    <div class="vol-order-top">
                        <span class="vol-order-status pending-status">â³ Pendiente</span>
                        <span class="vol-order-time">ğŸ• Hoy, 10:00 - 12:00</span>
                    </div>
                    <div class="vol-order-body">
                        <h3>MarÃ­a GarcÃ­a</h3>
                        <p class="vol-order-address">ğŸ“ Calle Gran VÃ­a 42, 28013</p>
                        <p class="vol-order-detail">Necesita ayuda con la compra semanal del supermercado.</p>
                    </div>
                    <div class="vol-order-actions">
                        <button class="btn-vol-accept" onclick="acceptOrder(this)">âœ… Aceptar</button>
                        <button class="btn-vol-reject" onclick="rejectOrder(this)">âŒ Rechazar</button>
                    </div>
                </div>

                <div class="vol-order-card pending">
                    <div class="vol-order-top">
                        <span class="vol-order-status pending-status">â³ Pendiente</span>
                        <span class="vol-order-time">ğŸ• MaÃ±ana, 09:30 - 11:00</span>
                    </div>
                    <div class="vol-order-body">
                        <h3>Antonio LÃ³pez</h3>
                        <p class="vol-order-address">ğŸ“ Calle AlcalÃ¡ 100, 28009</p>
                        <p class="vol-order-detail">AcompaÃ±amiento al mÃ©dico de cabecera.</p>
                    </div>
                    <div class="vol-order-actions">
                        <button class="btn-vol-accept" onclick="acceptOrder(this)">âœ… Aceptar</button>
                        <button class="btn-vol-reject" onclick="rejectOrder(this)">âŒ Rechazar</button>
                    </div>
                </div>

                <div class="vol-order-card pending">
                    <div class="vol-order-top">
                        <span class="vol-order-status pending-status">â³ Pendiente</span>
                        <span class="vol-order-time">ğŸ• MiÃ©rcoles, 17:00 - 18:30</span>
                    </div>
                    <div class="vol-order-body">
                        <h3>Carmen Ruiz</h3>
                        <p class="vol-order-address">ğŸ“ Paseo de la Castellana 15, 28046</p>
                        <p class="vol-order-detail">Ayuda para pasear y hacer ejercicio ligero en el parque.</p>
                    </div>
                    <div class="vol-order-actions">
                        <button class="btn-vol-accept" onclick="acceptOrder(this)">âœ… Aceptar</button>
                        <button class="btn-vol-reject" onclick="rejectOrder(this)">âŒ Rechazar</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ====== SECCIÃ“N: RUTA ====== -->
        <section id="section-ruta" class="vol-section">
            <div class="vol-section-header">
                <h2>ğŸ—ºï¸ Mi ruta de hoy</h2>
            </div>

            <div class="vol-route-timeline">
                <div class="vol-route-stop completed">
                    <div class="vol-route-marker">1</div>
                    <div class="vol-route-info">
                        <h3>MarÃ­a GarcÃ­a</h3>
                        <p class="vol-route-address">ğŸ“ Calle Gran VÃ­a 42, 28013</p>
                        <p class="vol-route-horario">ğŸ• 10:00 - 12:00</p>
                        <p class="vol-route-task">Compra semanal del supermercado</p>
                    </div>
                </div>

                <div class="vol-route-stop next">
                    <div class="vol-route-marker active">2</div>
                    <div class="vol-route-info">
                        <h3>Antonio LÃ³pez</h3>
                        <p class="vol-route-address">ğŸ“ Calle AlcalÃ¡ 100, 28009</p>
                        <p class="vol-route-horario">ğŸ• 12:30 - 14:00</p>
                        <p class="vol-route-task">AcompaÃ±amiento al mÃ©dico</p>
                        <button class="btn-vol-navigate" onclick="alert('Abriendo navegaciÃ³n GPS...')">ğŸ§­ Navegar</button>
                    </div>
                </div>

                <div class="vol-route-stop upcoming">
                    <div class="vol-route-marker">3</div>
                    <div class="vol-route-info">
                        <h3>Carmen Ruiz</h3>
                        <p class="vol-route-address">ğŸ“ Paseo de la Castellana 15, 28046</p>
                        <p class="vol-route-horario">ğŸ• 17:00 - 18:30</p>
                        <p class="vol-route-task">Paseo y ejercicio en el parque</p>
                    </div>
                </div>
            </div>
        </section>

    </div>

<script>
    // Section switching
    function showSection(name){
        document.querySelectorAll('.vol-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.vol-nav-link, .vol-mobile-tab').forEach(b => b.classList.remove('active'));
        document.getElementById('section-'+name).classList.add('active');
        document.querySelectorAll('[data-section="'+name+'"]').forEach(b => b.classList.add('active'));
    }

    // Order management
    function acceptOrder(btn){
        var card = btn.closest('.vol-order-card');
        card.classList.remove('pending');
        card.classList.add('accepted');
        card.querySelector('.vol-order-status').textContent = 'âœ… Aceptado';
        card.querySelector('.vol-order-status').className = 'vol-order-status accepted-status';
        card.querySelector('.vol-order-actions').innerHTML = '<button class="btn-vol-complete" onclick="completeOrder(this)">ğŸ‰ Marcar completado</button>';
        updateBadge();
    }
    function rejectOrder(btn){
        var card = btn.closest('.vol-order-card');
        card.classList.add('rejected');
        card.querySelector('.vol-order-status').textContent = 'âŒ Rechazado';
        card.querySelector('.vol-order-status').className = 'vol-order-status rejected-status';
        card.querySelector('.vol-order-actions').innerHTML = '';
        updateBadge();
    }
    function completeOrder(btn){
        var card = btn.closest('.vol-order-card');
        card.classList.add('done');
        card.querySelector('.vol-order-status').textContent = 'ğŸ‰ Completado';
        card.querySelector('.vol-order-status').className = 'vol-order-status done-status';
        card.querySelector('.vol-order-actions').innerHTML = '';
    }
    function updateBadge(){
        var pending = document.querySelectorAll('.vol-order-card.pending').length;
        var badge = document.querySelector('.vol-badge');
        if(badge) badge.textContent = pending + ' pendiente' + (pending !== 1 ? 's' : '');
    }
</script>

</body>
</html>
